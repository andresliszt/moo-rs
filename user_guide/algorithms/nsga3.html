
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Multi-objective optimization using genetic algorithms in Rust and Python.">
      
      
        <meta name="author" content="AndrÃ©s Sandoval">
      
      
      
        <link rel="prev" href="rnsga2.html">
      
      
        <link rel="next" href="agemoea.html">
      
      
      <link rel="icon" href="../../images/moors-logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>NSGA-III - moo-rs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nsga-iii" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="moo-rs" class="md-header__button md-logo" aria-label="moo-rs" data-md-component="logo">
      
  <img src="../../images/moors-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            moo-rs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NSGA-III
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/andresliszt/moo-rs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    andresliszt/moo-rs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../index.html" class="md-tabs__link">
          
  
  
  Get Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../development/setup_environment.html" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../fitness_and_constraints/fitness_and_constraints.html" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://docs.rs/moors/latest/moors/" class="md-tabs__link">
        
  
  
    
  
  API docs (moors)

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="moo-rs" class="md-nav__button md-logo" aria-label="moo-rs" data-md-component="logo">
      
  <img src="../../images/moors-logo.png" alt="logo">

    </a>
    moo-rs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/andresliszt/moo-rs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    andresliszt/moo-rs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Get Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to moo-rs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/knapsack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knapsack Problem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/real_valued.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Small Real Valued Problem
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/setup_environment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/setup_algorithm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Algorithm Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fitness_and_constraints/fitness_and_constraints.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitness and Constraints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/operators.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Genetic Operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../duplicates/duplicates.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Duplicates Cleaner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" checked>
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Algorithms
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction/introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="custom/custom.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Defined Genetic Operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nsga2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NSGA-II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rnsga2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNSGA-II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    NSGA-III
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="nsga3.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    NSGA-III
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference-point-association" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Point Association
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reference Point Association">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference-points-in-nsga-iii" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Points in NSGA-III
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-points-in-rnsga-ii" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Points in RNSGA-II
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dtlz2-for-3-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      DTLZ2 for 3 Objectives
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DTLZ2 for 3 Objectives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decision-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Decision Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Objective Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pareto-front-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Pareto Front Characteristics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#das-and-dennis-procedure-for-generating-reference-points" class="md-nav__link">
    <span class="md-ellipsis">
      Das and Dennis Procedure for Generating Reference Points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Das and Dennis Procedure for Generating Reference Points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-of-the-procedure" class="md-nav__link">
    <span class="md-ellipsis">
      Steps of the Procedure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#characteristics-and-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Characteristics and Comparison
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="agemoea.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AGE-MOEA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="revea.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    REVEA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="spea2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SPEA-II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ibea.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IBEA
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.rs/moors/latest/moors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API docs (moors)
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference-point-association" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Point Association
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reference Point Association">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference-points-in-nsga-iii" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Points in NSGA-III
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reference-points-in-rnsga-ii" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Points in RNSGA-II
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dtlz2-for-3-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      DTLZ2 for 3 Objectives
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DTLZ2 for 3 Objectives">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decision-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Decision Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objective-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Objective Functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pareto-front-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      Pareto Front Characteristics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#das-and-dennis-procedure-for-generating-reference-points" class="md-nav__link">
    <span class="md-ellipsis">
      Das and Dennis Procedure for Generating Reference Points
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Das and Dennis Procedure for Generating Reference Points">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-of-the-procedure" class="md-nav__link">
    <span class="md-ellipsis">
      Steps of the Procedure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#characteristics-and-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Characteristics and Comparison
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="nsga-iii">NSGA-III</h1>
<p>NSGA-III is a reference point-based evolutionary algorithm that extends the NSGA-II framework to handle multi-objective problems more effectively. In the context of 3-objective optimization, NSGA-III ensures a well-distributed approximation of the Pareto front by incorporating a set of pre-defined <strong>reference points</strong> to guide the selection process.</p>
<h2 id="key-features">Key Features</h2>
<ul>
<li>
<p><strong>Non-Dominated Sorting:</strong>
  The algorithm classifies the population into different fronts based on Pareto dominance, identifying the non-dominated solutions.</p>
</li>
<li>
<p><strong>Normalization:</strong>
  Objective values are normalized using the ideal and nadir points to account for differences in scale among objectives.</p>
</li>
<li>
<p><strong>Reference Point Association:</strong>
  A set of uniformly distributed reference points in the normalized objective space is predefined. Each solution is associated with the reference point to which it has the smallest perpendicular distance, ensuring a uniform spread across the Pareto front.</p>
</li>
<li>
<p><strong>Survival Selection:</strong>
  When the number of solutions exceeds the desired population size, NSGA-III selects individuals based on their perpendicular distance to the associated reference points, prioritizing those that contribute to both convergence and diversity.</p>
</li>
</ul>
<h3 id="reference-point-association">Reference Point Association</h3>
<p>Let <span class="arithmatex">\(\{\mathbf{r}^1, \mathbf{r}^2, \dots, \mathbf{r}^R\}\)</span> be a set of uniformly distributed reference points in the normalized space, where each <span class="arithmatex">\(\mathbf{r}^i \in \mathbb{R}^3\)</span>. The perpendicular distance from a solution <span class="arithmatex">\(\mathbf{f}'(\mathbf{x})\)</span> to a reference point <span class="arithmatex">\(\mathbf{r}\)</span> is calculated by:</p>
<div class="arithmatex">\[
d_\perp\left(\mathbf{f}'(\mathbf{x}), \mathbf{r}\right) = \left\| \mathbf{f}'(\mathbf{x}) - \left( \frac{\mathbf{f}'(\mathbf{x}) \cdot \mathbf{r}}{\|\mathbf{r}\|^2} \right) \mathbf{r} \right\|.
\]</div>
<p>Each solution is associated with the reference point that minimizes this perpendicular distance, guiding the selection process toward a balanced distribution along the Pareto front.</p>
<p>Reference points play a crucial role in guiding the search process in both NSGA-III and RNSGA-II, yet they are used in distinct ways.</p>
<h4 id="reference-points-in-nsga-iii">Reference Points in NSGA-III</h4>
<ul>
<li>
<p><strong>Association Mechanism:</strong>
  In NSGA-III, a set of uniformly distributed reference points (or directions) is generated in the normalized objective space. Each solution is associated with the reference point to which it has the smallest perpendicular distance.</p>
</li>
<li>
<p><strong>Niche Preservation:</strong>
  The environmental selection aims to fill as many niches as possible, ideally selecting one solution per reference point. This approach promotes a uniform spread of solutions along the Pareto front.</p>
</li>
<li>
<p><strong>Population and Reference Points Relationship:</strong>
  Although it might seem that the number of reference points is analogous to the population size, in practice the number of reference points is determined by the desired granularity (for example, using a parameter such as the number of divisions per objective). Thus, the set of reference points may be smaller or larger than the population size; the key objective is to cover the objective space effectively.</p>
</li>
</ul>
<h4 id="reference-points-in-rnsga-ii">Reference Points in RNSGA-II</h4>
<ul>
<li>
<p><strong>Multiple Associations:</strong>
  In contrast to NSGA-III, RNSGA-II incorporates reference points during the survival selection phase as an additional criterion. Here, a single reference point can influence the evaluation of multiple solutions. That is, several solutions can be compared based on their proximity to the same reference point.</p>
</li>
<li>
<p><strong>Selection Criteria:</strong>
  RNSGA-II ranks solutions not only by Pareto dominance and crowding distance but also by their closeness to the predefined reference points. This added metric helps steer the search toward regions of interest as specified by the decision-maker.</p>
</li>
<li>
<p><strong>Focus and Diversity:</strong>
  While NSGA-III uses reference points primarily to preserve a balanced distribution across the Pareto front (ideally one solution per reference point), RNSGA-II uses them to both maintain diversity and focus the search on promising regions. This means that in RNSGA-II, the same reference point may guide the selection of multiple solutions if they are all near that region.</p>
</li>
</ul>
<h4 id="comparison-summary">Comparison Summary</h4>
<ul>
<li><strong>Mapping:</strong></li>
<li><strong>NSGA-III:</strong> Strives for a one-to-one association between solutions and reference points, leading to a well-spread Pareto front.</li>
<li>
<p><strong>RNSGA-II:</strong> Allows multiple solutions to be associated with a single reference point, using proximity as an extra criterion to prioritize solutions.</p>
</li>
<li>
<p><strong>Role in the Algorithm:</strong></p>
</li>
<li><strong>NSGA-III:</strong> Uses reference points to divide the objective space into niches, ensuring uniform coverage.</li>
<li>
<p><strong>RNSGA-II:</strong> Integrates reference point proximity into the ranking mechanism alongside dominance and crowding, thus guiding the search toward specific areas of interest.</p>
</li>
<li>
<p><strong>Population Relation:</strong>
  While NSGA-III's reference points are designed to cover the objective space and might appear analogous to the population size, their actual number is set by algorithm parameters rather than being inherently equal to the number of solutions. In RNSGA-II, no such one-to-one expectation exists; a reference point can be linked to multiple solutions as needed.</p>
</li>
</ul>
<p>This nuanced difference highlights how NSGA-III and RNSGA-II employ reference points to balance convergence and diversity, each tailoring the mechanism to suit their specific selection strategies.</p>
<h2 id="dtlz2-for-3-objectives">DTLZ2 for 3 Objectives</h2>
<p>To evaluate NSGA-III in a 3-objective scenario, the DTLZ2 problem is a popular benchmark due to its continuous and convex Pareto front.</p>
<h3 id="decision-variables">Decision Variables</h3>
<p>Let the decision vector be <span class="arithmatex">\(\mathbf{x} = (x_1, x_2, \dots, x_n)\)</span> with each variable bounded by:</p>
<div class="arithmatex">\[
x_i \in [0, 1], \quad i = 1, 2, \dots, n.
\]</div>
<p>For a 3-objective version, the number of decision variables is typically set as:</p>
<div class="arithmatex">\[
n = 3 - 1 + k,
\]</div>
<p>where <span class="arithmatex">\(k\)</span> is the number of distance-related variables.</p>
<h3 id="objective-functions">Objective Functions</h3>
<p>DTLZ2 defines an auxiliary function:</p>
<div class="arithmatex">\[
g(\mathbf{x}) = \sum_{i=3}^{n} (x_i - 0.5)^2.
\]</div>
<p>The three objective functions are then given by:</p>
<div class="arithmatex">\[
f_1(\mathbf{x}) = (1 + g(\mathbf{x})) \cdot \cos\left(\frac{\pi}{2} x_1\right) \cdot \cos\left(\frac{\pi}{2} x_2\right),
\]</div>
<div class="arithmatex">\[
f_2(\mathbf{x}) = (1 + g(\mathbf{x})) \cdot \cos\left(\frac{\pi}{2} x_1\right) \cdot \sin\left(\frac{\pi}{2} x_2\right),
\]</div>
<div class="arithmatex">\[
f_3(\mathbf{x}) = (1 + g(\mathbf{x})) \cdot \sin\left(\frac{\pi}{2} x_1\right).
\]</div>
<h3 id="pareto-front-characteristics">Pareto Front Characteristics</h3>
<p>When <span class="arithmatex">\(g(\mathbf{x}) = 0\)</span>, the objective functions simplify to:</p>
<div class="arithmatex">\[
f_1(\mathbf{x}) = \cos\left(\frac{\pi}{2} x_1\right) \cdot \cos\left(\frac{\pi}{2} x_2\right),
\]</div>
<div class="arithmatex">\[
f_2(\mathbf{x}) = \cos\left(\frac{\pi}{2} x_1\right) \cdot \sin\left(\frac{\pi}{2} x_2\right),
\]</div>
<div class="arithmatex">\[
f_3(\mathbf{x}) = \sin\left(\frac{\pi}{2} x_1\right).
\]</div>
<p>These solutions lie on the surface of a unit hypersphere in the objective space, defined by:</p>
<div class="arithmatex">\[
f_1^2(\mathbf{x}) + f_2^2(\mathbf{x}) + f_3^2(\mathbf{x}) = 1.
\]</div>
<p>This continuous and convex Pareto front makes DTLZ2 an excellent test case to assess the balance between convergence and diversity in NSGA-III.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Rust</label><label for="__tabbed_1_2">Python</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">:</span><span class="nc">dep</span><span class="w"> </span><span class="n">ndarray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="p">:</span><span class="nc">dep</span><span class="w"> </span><span class="n">moors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="p">:</span><span class="nc">dep</span><span class="w"> </span><span class="n">plotly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;*&quot;</span>

<span class="k">use</span><span class="w"> </span><span class="n">ndarray</span><span class="p">::{</span><span class="n">Array1</span><span class="p">,</span><span class="w"> </span><span class="n">Array2</span><span class="p">,</span><span class="w"> </span><span class="n">Axis</span><span class="p">,</span><span class="w"> </span><span class="n">Ix2</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">moors</span><span class="p">::{</span>
<span class="w">    </span><span class="n">impl_constraints_fn</span><span class="p">,</span>
<span class="w">    </span><span class="n">algorithms</span><span class="p">::</span><span class="n">Nsga3Builder</span><span class="p">,</span>
<span class="w">    </span><span class="n">duplicates</span><span class="p">::</span><span class="n">CloseDuplicatesCleaner</span><span class="p">,</span>
<span class="w">    </span><span class="n">operators</span><span class="p">::{</span>
<span class="w">        </span><span class="n">GaussianMutation</span><span class="p">,</span>
<span class="w">        </span><span class="n">RandomSamplingFloat</span><span class="p">,</span>
<span class="w">        </span><span class="n">SimulatedBinaryCrossover</span><span class="p">,</span>
<span class="w">        </span><span class="n">DanAndDenisReferencePoints</span><span class="p">,</span>
<span class="w">        </span><span class="n">StructuredReferencePoints</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">genetic</span><span class="p">::</span><span class="n">Population</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">use</span><span class="w"> </span><span class="n">plotly</span><span class="p">::{</span><span class="n">Plot</span><span class="p">,</span><span class="w"> </span><span class="n">Scatter3D</span><span class="p">,</span><span class="w"> </span><span class="n">Layout</span><span class="p">,</span><span class="w"> </span><span class="n">Trace</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">plotly</span><span class="p">::</span><span class="n">common</span><span class="p">::{</span><span class="n">Mode</span><span class="p">,</span><span class="w"> </span><span class="n">Marker</span><span class="p">,</span><span class="w"> </span><span class="n">Title</span><span class="p">,</span><span class="w"> </span><span class="n">MarkerSymbol</span><span class="p">};</span>
<span class="k">use</span><span class="w"> </span><span class="n">plotly</span><span class="p">::</span><span class="n">color</span><span class="p">::</span><span class="n">NamedColor</span><span class="p">;</span>
<span class="k">use</span><span class="w"> </span><span class="n">plotly</span><span class="p">::</span><span class="n">layout</span><span class="p">::{</span><span class="n">LayoutScene</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Scene</span><span class="p">,</span><span class="w"> </span><span class="n">Axis</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">PlotlyAxis</span><span class="p">};</span>


<span class="sd">/// Evaluate the DTLZ2 objectives for a 3-objective problem.</span>
<span class="sd">///</span>
<span class="sd">/// The decision vector x has num_vars components. For the Pareto front,</span>
<span class="sd">/// the auxiliary function g(x) is minimized (g(x)=0) by setting the last</span>
<span class="sd">/// num_vars-2 variables to 0.5.</span>
<span class="sd">///</span>
<span class="sd">/// The objectives are computed as:</span>
<span class="sd">///   f1(x) = (1+g) * cos((pi/2)*x1) * cos((pi/2)*x2)</span>
<span class="sd">///   f2(x) = (1+g) * cos((pi/2)*x1) * sin((pi/2)*x2)</span>
<span class="sd">///   f3(x) = (1+g) * sin((pi/2)*x1)</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">evaluate_dtlz2</span><span class="p">(</span><span class="n">genes</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Array2</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Array2</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">.</span><span class="n">nrows</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="kt">f64</span><span class="p">::</span><span class="n">consts</span><span class="p">::</span><span class="n">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Compute the auxiliary function g(x) using variables 3 to num_vars.</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">.</span><span class="n">slice</span><span class="p">(</span><span class="n">s</span><span class="o">!</span><span class="p">[</span><span class="o">..</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">..</span><span class="p">]).</span><span class="n">to_owned</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">g_vec</span><span class="p">:</span><span class="w"> </span><span class="nc">Array1</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tail</span><span class="p">.</span><span class="n">mapv</span><span class="p">(</span><span class="o">|</span><span class="n">v</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">).</span><span class="n">powi</span><span class="p">(</span><span class="mi">2</span><span class="p">)).</span><span class="n">sum_axis</span><span class="p">(</span><span class="n">Axis</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// x1, x2</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">to_owned</span><span class="p">();</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">genes</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">to_owned</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Trig terms</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">cos_x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x1</span><span class="p">.</span><span class="n">mapv</span><span class="p">(</span><span class="o">|</span><span class="n">v</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">).</span><span class="n">cos</span><span class="p">());</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">cos_x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="p">.</span><span class="n">mapv</span><span class="p">(</span><span class="o">|</span><span class="n">v</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">).</span><span class="n">cos</span><span class="p">());</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sin_x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x1</span><span class="p">.</span><span class="n">mapv</span><span class="p">(</span><span class="o">|</span><span class="n">v</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">).</span><span class="n">sin</span><span class="p">());</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">sin_x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x2</span><span class="p">.</span><span class="n">mapv</span><span class="p">(</span><span class="o">|</span><span class="n">v</span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">).</span><span class="n">sin</span><span class="p">());</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">one_plus_g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_vec</span><span class="p">.</span><span class="n">mapv</span><span class="p">(</span><span class="o">|</span><span class="n">g</span><span class="o">|</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// f1, f2, f3 as Array1</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">one_plus_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&amp;</span><span class="n">cos_x1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&amp;</span><span class="n">cos_x2</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">one_plus_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&amp;</span><span class="n">cos_x1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sin_x2</span><span class="p">;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">one_plus_g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sin_x1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Stack into (n, 3)</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Array2</span><span class="p">::</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="p">::</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">));</span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">column_mut</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">assign</span><span class="p">(</span><span class="o">&amp;</span><span class="n">f1</span><span class="p">);</span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">column_mut</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">assign</span><span class="p">(</span><span class="o">&amp;</span><span class="n">f2</span><span class="p">);</span>
<span class="w">    </span><span class="n">result</span><span class="p">.</span><span class="n">column_mut</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">assign</span><span class="p">(</span><span class="o">&amp;</span><span class="n">f3</span><span class="p">);</span>
<span class="w">    </span><span class="n">result</span>
<span class="p">}</span>

<span class="sd">/// Compute a set of points approximating the theoretical Pareto front for DTLZ2 (3 objectives).</span>
<span class="sd">///</span>
<span class="sd">/// For the Pareto-optimal front, g(x) = 0, which implies that the decision variables</span>
<span class="sd">/// x_3, ..., x_n are fixed at 0.5. Therefore, the front can be generated by varying x1 and x2:</span>
<span class="sd">///   f1 = cos((pi/2)*x1) * cos((pi/2)*x2)</span>
<span class="sd">///   f2 = cos((pi/2)*x1) * sin((pi/2)*x2)</span>
<span class="sd">///   f3 = sin((pi/2)*x1)</span>
<span class="sd">/// These points lie on a portion of the unit hypersphere in the positive orthant.</span>
<span class="k">fn</span><span class="w"> </span><span class="nf">dtlz2_theoretical_front</span><span class="p">(</span><span class="n">num_points</span><span class="p">:</span><span class="w"> </span><span class="kt">usize</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="kt">f64</span><span class="p">::</span><span class="n">consts</span><span class="p">::</span><span class="n">PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">f1_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Vec</span><span class="p">::</span><span class="n">with_capacity</span><span class="p">(</span><span class="n">num_points</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num_points</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">f2_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Vec</span><span class="p">::</span><span class="n">with_capacity</span><span class="p">(</span><span class="n">num_points</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num_points</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">f3_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Vec</span><span class="p">::</span><span class="n">with_capacity</span><span class="p">(</span><span class="n">num_points</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num_points</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">..</span><span class="n">num_points</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">num_points</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">num_points</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="mf">0.0</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="o">..</span><span class="n">num_points</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">num_points</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">j</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">num_points</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="kt">f64</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="mf">0.0</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x1</span><span class="p">).</span><span class="n">cos</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x2</span><span class="p">).</span><span class="n">cos</span><span class="p">();</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x1</span><span class="p">).</span><span class="n">cos</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x2</span><span class="p">).</span><span class="n">sin</span><span class="p">();</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">f3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pi_over_2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x1</span><span class="p">).</span><span class="n">sin</span><span class="p">();</span>

<span class="w">            </span><span class="n">f1_all</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">f1</span><span class="p">);</span>
<span class="w">            </span><span class="n">f2_all</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">f2</span><span class="p">);</span>
<span class="w">            </span><span class="n">f3_all</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">f3</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">(</span><span class="n">f1_all</span><span class="p">,</span><span class="w"> </span><span class="n">f2_all</span><span class="p">,</span><span class="w"> </span><span class="n">f3_all</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Set up the NSGA-III algorithm for DTLZ2.</span>
<span class="c1">// For DTLZ2, a typical choice is num_vars = (number of objectives - 1) + k.</span>
<span class="c1">// Here, we choose k = 10, so num_vars = 2 + 10 = 12.</span>
<span class="n">impl_constraints_fn</span><span class="o">!</span><span class="p">(</span><span class="n">BoundConstraints</span><span class="p">,</span><span class="w"> </span><span class="n">lower_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">upper_bound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">);</span>


<span class="kd">let</span><span class="w"> </span><span class="n">population</span><span class="p">:</span><span class="w"> </span><span class="nc">Population</span><span class="o">&lt;</span><span class="n">Ix2</span><span class="p">,</span><span class="w"> </span><span class="n">Ix2</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">rp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DanAndDenisReferencePoints</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">).</span><span class="n">generate</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">algorithm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nsga3Builder</span><span class="p">::</span><span class="n">default</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="n">sampler</span><span class="p">(</span><span class="n">RandomSamplingFloat</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="n">crossover</span><span class="p">(</span><span class="n">SimulatedBinaryCrossover</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="mf">10.0</span><span class="p">))</span><span class="w"> </span><span class="c1">// distribution_index = 10</span>
<span class="w">        </span><span class="p">.</span><span class="n">mutation</span><span class="p">(</span><span class="n">GaussianMutation</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">))</span><span class="w">     </span><span class="c1">// gene_mutation_rate = 0.1, sigma = 0.01</span>
<span class="w">        </span><span class="p">.</span><span class="n">reference_points</span><span class="p">(</span><span class="n">reference_points</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">are_aspirational</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">fitness_fn</span><span class="p">(</span><span class="n">evaluate_dtlz2</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">constraints_fn</span><span class="p">(</span><span class="n">BoundConstraints</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">duplicates_cleaner</span><span class="p">(</span><span class="n">CloseDuplicatesCleaner</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="n">num_vars</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">population_size</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">num_offsprings</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">num_iterations</span><span class="p">(</span><span class="mi">700</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">mutation_rate</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">crossover_rate</span><span class="p">(</span><span class="mf">0.9</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">keep_infeasible</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">verbose</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1729</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">build</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Failed to build NSGA3&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Run the algorithm</span>
<span class="w">    </span><span class="n">algorithm</span><span class="p">.</span><span class="n">run</span><span class="p">().</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;NSGA3 run failed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">algorithm</span><span class="p">.</span><span class="n">population</span><span class="p">.</span><span class="n">unwrap</span><span class="p">().</span><span class="n">clone</span><span class="p">()</span>
<span class="p">};</span>

<span class="c1">// Define again rp just for plotting</span>
<span class="kd">let</span><span class="w"> </span><span class="n">rp_plot</span><span class="p">:</span><span class="w"> </span><span class="nc">Array2</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DanAndDenisReferencePoints</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">).</span><span class="n">generate</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">rp_f1</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rp_plot</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">to_vec</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">rp_f2</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rp_plot</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">to_vec</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">rp_f3</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rp_plot</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">to_vec</span><span class="p">();</span>

<span class="c1">// Get the best Pareto front obtained (as a Population instance)</span>
<span class="kd">let</span><span class="w"> </span><span class="n">fitness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">population</span><span class="p">.</span><span class="n">fitness</span><span class="p">;</span>

<span class="c1">// Extract the obtained fitness values (each row is [f1, f2, f3])</span>
<span class="kd">let</span><span class="w"> </span><span class="n">f1_found</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitness</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">to_vec</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">f2_found</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitness</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">to_vec</span><span class="p">();</span>
<span class="kd">let</span><span class="w"> </span><span class="n">f3_found</span><span class="p">:</span><span class="w"> </span><span class="nb">Vec</span><span class="o">&lt;</span><span class="kt">f64</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fitness</span><span class="p">.</span><span class="n">column</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">to_vec</span><span class="p">();</span>

<span class="c1">// Compute the theoretical Pareto front for DTLZ2 (dense grid on the positive octant of the unit sphere)</span>
<span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">f1_theo</span><span class="p">,</span><span class="w"> </span><span class="n">f2_theo</span><span class="p">,</span><span class="w"> </span><span class="n">f3_theo</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtlz2_theoretical_front</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>

<span class="c1">// Build Plotly traces for 3D scatter (theoretical vs obtained)</span>
<span class="kd">let</span><span class="w"> </span><span class="n">theoretical_trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Scatter3D</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">f1_theo</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">f2_theo</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">f3_theo</span><span class="p">.</span><span class="n">clone</span><span class="p">())</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="n">Mode</span><span class="p">::</span><span class="n">Markers</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Theoretical Pareto Front&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">marker</span><span class="p">(</span><span class="n">Marker</span><span class="p">::</span><span class="n">new</span><span class="p">().</span><span class="n">size</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">color</span><span class="p">(</span><span class="n">NamedColor</span><span class="p">::</span><span class="n">Black</span><span class="p">).</span><span class="n">opacity</span><span class="p">(</span><span class="mf">0.5</span><span class="p">));</span>

<span class="kd">let</span><span class="w"> </span><span class="n">obtained_trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Scatter3D</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">f1_found</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">f2_found</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="n">f3_found</span><span class="p">.</span><span class="n">clone</span><span class="p">())</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="n">Mode</span><span class="p">::</span><span class="n">Markers</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Obtained Front&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">marker</span><span class="p">(</span><span class="n">Marker</span><span class="p">::</span><span class="n">new</span><span class="p">().</span><span class="n">size</span><span class="p">(</span><span class="mi">5</span><span class="p">).</span><span class="n">color</span><span class="p">(</span><span class="n">NamedColor</span><span class="p">::</span><span class="n">Red</span><span class="p">));</span>

<span class="kd">let</span><span class="w"> </span><span class="n">refpoints_trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Scatter3D</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">rp_f1</span><span class="p">,</span><span class="w"> </span><span class="n">rp_f2</span><span class="p">,</span><span class="w"> </span><span class="n">rp_f3</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="n">Mode</span><span class="p">::</span><span class="n">Markers</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Reference Points&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">marker</span><span class="p">(</span>
<span class="w">        </span><span class="n">Marker</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="n">color</span><span class="p">(</span><span class="n">NamedColor</span><span class="p">::</span><span class="n">Magenta</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="n">symbol</span><span class="p">(</span><span class="n">MarkerSymbol</span><span class="p">::</span><span class="n">Star</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="c1">// Layout con Title builder y PlotlyAxis (alias para evitar conflicto con ndarray::Axis)</span>
<span class="kd">let</span><span class="w"> </span><span class="n">layout</span><span class="p">:</span><span class="w"> </span><span class="nc">Layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Layout</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">width</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">height</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">Title</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;DTLZ2 Pareto Front: Theoretical vs Obtained (NSGA-III)&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">.</span><span class="n">scene</span><span class="p">(</span>
<span class="w">        </span><span class="n">Scene</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="n">x_axis</span><span class="p">(</span><span class="n">PlotlyAxis</span><span class="p">::</span><span class="n">new</span><span class="p">().</span><span class="n">title</span><span class="p">(</span><span class="n">Title</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;f&lt;sub&gt;1&lt;/sub&gt;&quot;</span><span class="p">)))</span>
<span class="w">            </span><span class="p">.</span><span class="n">y_axis</span><span class="p">(</span><span class="n">PlotlyAxis</span><span class="p">::</span><span class="n">new</span><span class="p">().</span><span class="n">title</span><span class="p">(</span><span class="n">Title</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;f&lt;sub&gt;2&lt;/sub&gt;&quot;</span><span class="p">)))</span>
<span class="w">            </span><span class="p">.</span><span class="n">z_axis</span><span class="p">(</span><span class="n">PlotlyAxis</span><span class="p">::</span><span class="n">new</span><span class="p">().</span><span class="n">title</span><span class="p">(</span><span class="n">Title</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;f&lt;sub&gt;3&lt;/sub&gt;&quot;</span><span class="p">)))</span>
<span class="w">        </span><span class="c1">// .aspect_mode(plotly::layout::scene::AspectMode::Cube) // opcional</span>
<span class="w">    </span><span class="p">);</span>

<span class="c1">// Compose the plot</span>
<span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Plot</span><span class="p">::</span><span class="n">new</span><span class="p">();</span>
<span class="n">plot</span><span class="p">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">theoretical_trace</span><span class="p">);</span>
<span class="n">plot</span><span class="p">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">obtained_trace</span><span class="p">);</span>
<span class="n">plot</span><span class="p">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">refpoints_trace</span><span class="p">);</span>
<span class="n">plot</span><span class="p">.</span><span class="n">set_layout</span><span class="p">(</span><span class="n">layout</span><span class="p">);</span>

<span class="c1">// Render as rich HTML for evcxr</span>
<span class="kd">let</span><span class="w"> </span><span class="n">html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot</span><span class="p">.</span><span class="n">to_html</span><span class="p">();</span>
<span class="fm">println!</span><span class="p">(</span><span class="s">&quot;EVCXR_BEGIN_CONTENT text/html</span><span class="se">\n</span><span class="s">{}</span><span class="se">\n</span><span class="s">EVCXR_END_CONTENT&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">html</span><span class="p">);</span>
</code></pre></div>
<p><img alt="png" src="images/nsga3_rust.png" /></p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pymoors</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Nsga3</span><span class="p">,</span>
    <span class="n">DanAndDenisReferencePoints</span><span class="p">,</span>
    <span class="n">RandomSamplingFloat</span><span class="p">,</span>
    <span class="n">GaussianMutation</span><span class="p">,</span>
    <span class="n">SimulatedBinaryCrossover</span><span class="p">,</span>
    <span class="n">CloseDuplicatesCleaner</span><span class="p">,</span>
    <span class="n">Constraints</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymoors.schemas</span><span class="w"> </span><span class="kn">import</span> <span class="n">Population</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymoors.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TwoDArray</span>

<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_dtlz2</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">TwoDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TwoDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the DTLZ2 objectives for a 3-objective problem.</span>

<span class="sd">    The decision vector x has num_vars components. For the Pareto front,</span>
<span class="sd">    the auxiliary function g(x) is minimized (g(x)=0) by setting the last</span>
<span class="sd">    num_vars-2 variables to 0.5.</span>

<span class="sd">    The objectives are computed as:</span>
<span class="sd">      f1(x) = (1+g) * cos((pi/2)*x1) * cos((pi/2)*x2)</span>
<span class="sd">      f2(x) = (1+g) * cos((pi/2)*x1) * sin((pi/2)*x2)</span>
<span class="sd">      f3(x) = (1+g) * sin((pi/2)*x1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Compute the auxiliary function g(x) using variables 3 to num_vars.</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">f3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">dtlz2_theoretical_front</span><span class="p">(</span><span class="n">num_points</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute a set of points approximating the theoretical Pareto front for DTLZ2 (3 objectives).</span>

<span class="sd">    For the Pareto-optimal front, g(x) = 0, which implies that the decision variables</span>
<span class="sd">    x_3, ..., x_n are fixed at 0.5. Therefore, the front can be generated by varying x1 and x2:</span>
<span class="sd">      f1 = cos((pi/2)*x1) * cos((pi/2)*x2)</span>
<span class="sd">      f2 = cos((pi/2)*x1) * sin((pi/2)*x2)</span>
<span class="sd">      f3 = sin((pi/2)*x1)</span>
<span class="sd">    These points lie on a portion of the unit hypersphere in the positive orthant.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
    <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">X1_flat</span> <span class="o">=</span> <span class="n">X1</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">X2_flat</span> <span class="o">=</span> <span class="n">X2</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="n">f1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X1_flat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X2_flat</span><span class="p">)</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X1_flat</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X2_flat</span><span class="p">)</span>
    <span class="n">f3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X1_flat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span>


<span class="c1"># Create the reference points using DanAndDenisReferencePoints.</span>
<span class="c1"># This object generates reference points for NSGA-III.</span>
<span class="n">ref_points</span> <span class="o">=</span> <span class="n">DanAndDenisReferencePoints</span><span class="p">(</span><span class="n">n_reference_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_objectives</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Set up the NSGA-III algorithm for DTLZ2.</span>
<span class="c1"># For DTLZ2, a typical choice is num_vars = (number of objectives - 1) + k.</span>
<span class="c1"># Here, we choose k = 10, so num_vars = 2 + 10 = 12.</span>
<span class="n">algorithm</span> <span class="o">=</span> <span class="n">Nsga3</span><span class="p">(</span>
    <span class="n">sampler</span><span class="o">=</span><span class="n">RandomSamplingFloat</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">crossover</span><span class="o">=</span><span class="n">SimulatedBinaryCrossover</span><span class="p">(</span><span class="n">distribution_index</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">mutation</span><span class="o">=</span><span class="n">GaussianMutation</span><span class="p">(</span><span class="n">gene_mutation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
    <span class="n">fitness_fn</span><span class="o">=</span><span class="n">evaluate_dtlz2</span><span class="p">,</span>
    <span class="n">constraints_fn</span><span class="o">=</span><span class="n">Constraints</span><span class="p">(</span><span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span>
    <span class="n">duplicates_cleaner</span><span class="o">=</span><span class="n">CloseDuplicatesCleaner</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">),</span>
    <span class="n">num_vars</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">population_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">num_offsprings</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">num_iterations</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
    <span class="n">mutation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">crossover_rate</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="n">keep_infeasible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">reference_points</span><span class="o">=</span><span class="n">ref_points</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">1729</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Run the algorithm</span>
<span class="n">algorithm</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Get the best Pareto front obtained (as a Population instance)</span>
<span class="n">best</span><span class="p">:</span> <span class="n">Population</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">best_as_population</span>
<span class="n">obtained_fitness</span> <span class="o">=</span> <span class="n">best</span><span class="o">.</span><span class="n">fitness</span>  <span class="c1"># Shape: (num_solutions, 3)</span>

<span class="c1"># Compute the theoretical Pareto front for DTLZ2</span>
<span class="n">f1_theo</span><span class="p">,</span> <span class="n">f2_theo</span><span class="p">,</span> <span class="n">f3_theo</span> <span class="o">=</span> <span class="n">dtlz2_theoretical_front</span><span class="p">(</span><span class="n">num_points</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Plot the theoretical Pareto front, the obtained front, and the reference points in 3D.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

<span class="c1"># Plot the theoretical Pareto front as a scatter of many points.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">f1_theo</span><span class="p">,</span>
    <span class="n">f2_theo</span><span class="p">,</span>
    <span class="n">f3_theo</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Theoretical Pareto Front&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Plot the obtained Pareto front from the algorithm.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">obtained_fitness</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">obtained_fitness</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">obtained_fitness</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Obtained Front&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Plot the reference points.</span>
<span class="c1"># Extract the reference points array from the DanAndDenisReferencePoints object.</span>
<span class="n">ref_points_array</span> <span class="o">=</span> <span class="n">ref_points</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">ref_points_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">ref_points_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">ref_points_array</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reference Points&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$f_1$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$f_2$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s2">&quot;$f_3$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;DTLZ2 Pareto Front: Theoretical vs Obtained (NSGA-III)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="images/nsga3_python.png" /></p>
</div>
</div>
</div>
<h2 id="das-and-dennis-procedure-for-generating-reference-points">Das and Dennis Procedure for Generating Reference Points</h2>
<p>The Das and Dennis procedure is a systematic method for generating a uniformly distributed set of reference points on the unit simplex in the objective space. This technique is widely used in multi-objective optimization algorithms, such as NSGA-III, to guide the search process by ensuring balanced coverage of the Pareto front.</p>
<h3 id="steps-of-the-procedure">Steps of the Procedure</h3>
<ol>
<li>
<p><strong>Define the Number of Objectives and Divisions:</strong>
   For a problem with <span class="arithmatex">\(M\)</span> objectives, choose a parameter <span class="arithmatex">\(H\)</span> (sometimes denoted as <span class="arithmatex">\(p\)</span>) which represents the number of divisions along each axis of the objective space. This parameter <span class="arithmatex">\( H \)</span> determines the granularity of the generated reference points.</p>
</li>
<li>
<p><strong>Generate Integer Combinations:</strong>
   Generate all combinations of non-negative integers <span class="arithmatex">\((a_1, a_2, \dots, a_M)\)</span> that satisfy:
   $$
   a_1 + a_2 + \cdots + a_M = H.
   $$
   Each combination represents a unique way of partitioning the total number of divisions among the objectives.</p>
</li>
<li>
<p><strong>Map to the Simplex:</strong>
   Each integer combination is then mapped to a reference point on the unit simplex using:
   $$
   \mathbf{r} = \left(\frac{a_1}{H}, \frac{a_2}{H}, \dots, \frac{a_M}{H}\right).
   $$
   Since the components of <span class="arithmatex">\(\mathbf{r}\)</span> sum to 1, every point lies on the unit simplex, ensuring a uniform distribution across the objective space.</p>
</li>
</ol>
<h3 id="characteristics-and-comparison">Characteristics and Comparison</h3>
<ul>
<li>
<p><strong>Uniformity:</strong>
  The procedure guarantees that the generated reference points are uniformly distributed over the simplex. This uniformity is critical for effectively exploring all regions of the Pareto front.</p>
</li>
<li>
<p><strong>Relation to Population:</strong>
  In NSGA-III, each solution is associated with the nearest reference point based on a perpendicular distance metric. Although the number of reference points is not strictly equal to the population size, they are designed to cover the objective space in such a way that promotes diver</p>
</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "content.code.copy", "announce.dismiss", "navigation.tabs", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../js/custom_mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>